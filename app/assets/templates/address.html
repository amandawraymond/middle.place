<div ng-controller="AddressCtrl">

  <h1>I want to find
    <select class="btn btn-primary btn-lg" ng-model="placeType">
      <option value="free wifi">free wifi</option>
      <option value="food">food</option>
      <option value="coffee">coffee</option>
      <option value="bar">bars</option>
      <option value="fast food">fast food</option>
      <option value="hotel">hotels</option>
      <option value="yogurt">yogurt</option>
      <option value="">anything</option>
    </select>
    in the MiddleOf.Us
  </h1>

  <form name="addressForm" ng-submit="submitInfo();">
    <span style="padding-bottom:10px;display:inline-block;">
      Starting point (or <a ng-click="getGeolocation();"><i class="fa fa-location-arrow"></i> Use My Location</a>)
      <div class="inline-block" ng-show="isGeolocationProcessing"><i class="fa fa-spin fa-spinner validation-indicator"></i></div>
      <span ng-show="isGeolocationError">Enable location services</span>
    </span>
    <div ng-repeat="address in addresses">
      <p ng-show="addresses.indexOf(address) == 1">
        Other(s) <a ng-click="addLocation();"><i class="fa fa-plus validation-indicator" style="margin-top:5px"></i> Add Location</a>
      </p>
      <input type="text" ng-model="address.address" placeholder="{{address.placeholder}}" ng-debounce="300" class="col-md-5" autofocus="true">
      
      <a ng-click="removeLocation(address);" ng-show="addresses.indexOf(address) != 0"><i class="fa fa-minus validation-indicator top-pad"></i></a>
      <div class="address-status" style="margin-bottom:5px;font-size:80%" ng-class="{'first-address': addresses.indexOf(address) == 0, 'other-addresses': addresses.indexOf(address) > 0}">
        <span class="white" ng-show="address.isEmpty && !address.isProcessing">Placeholder</span>
        <span ng-show="address.isProcessing">Searching...</span>
        <span class="green" ng-show="address.isValid && !address.isEmpty">Found: {{address.foundAddress}}</span>
        <span class="red" ng-hide="address.isValid || address.isEmpty">Address not found</span>
      </div>
      <p ng-show="addresses.length == 1"><a ng-click="addLocation();"><i class="fa fa-plus validation-indicator" style="margin-top:5px"></i> Add Location</a></p>
    </div>
    <br>
    <button type="submit" ng-disabled="addressForm.$invalid || !isAllValid || isAllEmpty" ng-click="processing=true" ng-init="processing=false" class="btn btn-primary">
      Get Places
    </button>
    <div ng-show="processing" style="display:inline-block;"><i class="fa fa-spin fa-spinner"style="display:inline-block;"></i></div>
  </form>

  <div ng-show="results && !selectedResult">
    <h2 id="results">Closest {{results.length}} results</h2>
    <p>Click for more info</p>
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Name</th>
          <th ng-show="addressesOnly.length > 1">From Midpoint</th>
          <th ng-hide="addressesOnly.length > 1">Distance</th>
          <th>Yelp Rating</th>
          <th>Address</th>
        </tr>
      </thead>
      <tbody id="results">
        <tr ng-repeat="result in results" ng-click="selectResult(result);" ng-class="{success: result.deals}">
          <td>
            <i class="fa fa-dollar strong" style="margin-right:5px;" ng-show="result.deals"></i>{{result.name}}
          </td>
          <td>{{result.distance}} mile(s)</td>
          <td><img src="{{result.rating_image}}" /></td>
          <td>{{result.address}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div ng-show="error">
    <h2>{{error}}</h2>
  </div>
  <div ng-show="selectedResult">
    <div class="alert alert-dismissable alert-primary">
      <button type="button" class="close" ng-click="clearSelectedResult();">close</button>
      <h2>{{selectedResult.name}}</h2>
      <table>
        <tbody>
          <tr>
            <td><h5 style="display:inline"><strong>Yelp rating:</strong></h5></td>
            <td><h5 style="display:inline;margin-left:10px">{{selectedResult.rating}} / 5</h5></td>
          </tr>
          <tr>
            <td><h5 style="display:inline"><strong>Address:</strong></h5></td>
            <td><h5 style="display:inline-block;margin-left:10px">{{selectedResult.address}}</h5></td>
          </tr>
        </tbody>
      </table>
      <br>
      <h4>Actions:</h4>
      <a href="{{selectedResult.deals['hash']['purchase_url']}}" class="btn btn-success" target="_blank" ng-show="selectedResult.deals">Coupon: {{selectedResult.deals["hash"]["title"]}}</a>
      <a href="{{selectedResult.website}}" class="btn btn-info" target="_blank">View on Yelp</a>
      <a href="https://maps.google.com?q={{selectedResult.address}}" class="btn btn-info" target="_blank">View on Google Maps</a>
      <br><br>
      <h4>Text Address To:</h4>
      <input type="text" ng-model="phoneNumber" style="height:38px;color:black;font-size:150%" placeholder="5558675309">
      <button ng-click="createMessage()" class="btn btn-info" style="margin-top:-5px;">Send</button>
      <div ng-show="sendingText" style="display:inline-block;"><i class="fa fa-spin fa-spinner" style="display:inline-block;"></i></div>
      <i ng-show="sentText"  class="fa fa-check white validation-indicator"></i>
      <i ng-show="textError"  class="fa fa-times white validation-indicator"></i>
    </div>
  </div>
</div>